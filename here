const filterNodes = (nodes, term, parentName = '') => {
  return nodes.reduce((filtered, node) => {
    const nodeMatches = node.name.toLowerCase().includes(term);
    const childMatches = node.children && filterNodes(node.children, term, node.name).length > 0;

    if (nodeMatches || childMatches) {
      // Include only the current node if it matches the search term or its children match
      filtered.push({
        ...node,
        children: filterNodes(node.children, term, node.name)
      });
    } else if (node.name.toLowerCase() === parentName.toLowerCase()) {
      // Include the parent node even if it does not match the search term
      filtered.push({
        ...node,
        children: filterNodes(node.children, term, node.name)
      });
    }

    return filtered;
  }, []);
};
