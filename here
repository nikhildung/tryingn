import React, { useState } from "react";
import { Treebeard } from "react-treebeard";
import "./Sidebarsection.css";
import jsonData from "./ExploreAPIPage.json";
import TilesRendering from "./TilesRendering";

const TreeView = () => {
  const [data, setData] = useState({
    name: "Categories",
    toggled: true,
    children: jsonData,
  });
  const [selectedNode, setSelectedNode] = useState(null);

  const handleToggle = (node, toggled) => {
    if (selectedNode) {
      selectedNode.active = false;
    }

    node.active = true;
    if (node.children) {
      node.toggled = toggled;
    }

    setSelectedNode(node);

    if (node.href) {
      window.location.href = "apitemplate";
    }

    setData(Object.assign({}, data));
  };

  return (
    <div className="gridlayout">
      <aside className="API_aside">
        <h2>Categories</h2>
        <Treebeard data={data} onToggle={(node, toggled) => handleToggle(node, toggled)} />
      </aside>

      <section className="featured_products_list">
        {selectedNode && selectedNode.children && (
          <ul className="featured_products_list">
            {selectedNode.children.map((child) => (
              <TilesRendering key={child.id} selectedNode={child} />
            ))}
          </ul>
        )}
      </section>
    </div>
  );
};

export default TreeView;
